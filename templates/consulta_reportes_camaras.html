{% extends 'base_sidebar.html' %}
{% load static %}

{% block title %}Consulta C치maras{% endblock %}
{% block page_title %}Consulta de Reportes de C치maras{% endblock %}
{% block page_subtitle %}Historial de monitoreo de c치maras de vigilancia{% endblock %}

{% block extra_styles %}
<style>
    .content-wrapper { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); }
    .filters-section { background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 25px; }
    .filters-title { font-size: 1.1em; font-weight: 700; color: #1e3a5f; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
    .filters-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px; }
    .filter-item { display: flex; flex-direction: column; gap: 6px; }
    .filter-item label { font-size: 0.85em; font-weight: 600; color: #495057; }
    .filter-item input, .filter-item select { padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 0.95em; }
    .filter-actions { display: flex; gap: 12px; justify-content: flex-end; }
    .btn-filter { padding: 10px 25px; background: linear-gradient(135deg, #17a2b8, #138496); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px; }
    .btn-clear { padding: 10px 25px; background: #6c757d; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
    .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .results-title { font-size: 1.1em; font-weight: 700; color: #1e3a5f; }
    .results-count { font-size: 0.9em; color: #6c757d; }
    .table-container { overflow-x: auto; }
    .reports-table { width: 100%; border-collapse: collapse; min-width: 700px; }
    .reports-table th { background: linear-gradient(135deg, #1e3a5f 0%, #0a1929 100%); color: white; padding: 14px 12px; text-align: left; font-size: 0.85em; font-weight: 600; }
    .reports-table td { padding: 12px; border-bottom: 1px solid #eee; font-size: 0.9em; }
    .reports-table tbody tr:hover { background: #f8f9fa; }
    .badge { display: inline-block; padding: 5px 12px; border-radius: 15px; font-size: 0.8em; font-weight: 600; }
    .badge-success { background: #d4edda; color: #155724; }
    .badge-warning { background: #fff3cd; color: #856404; }
    .btn-view { padding: 6px 12px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.8em; margin-right: 5px; }
    .btn-edit { padding: 6px 12px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.8em; margin-right: 5px; }
    .btn-delete { padding: 6px 12px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.8em; }
    .empty-message { text-align: center; padding: 40px; color: #999; }
    .empty-icon { font-size: 2em; margin-bottom: 10px; }
    .loading { text-align: center; padding: 40px; display: none; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; }
    .modal-content { max-width: 800px; margin: 50px auto; background: white; border-radius: 12px; overflow: hidden; }
    .modal-header { background: linear-gradient(135deg, #17a2b8, #138496); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
    .modal-title { font-size: 1.2em; font-weight: 700; }
    .modal-close { background: rgba(255,255,255,0.2); border: none; color: white; font-size: 1.5em; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; }
    .modal-body { padding: 25px; max-height: 70vh; overflow-y: auto; }
</style>
{% endblock %}

{% block header_actions %}
<a href="{% url 'reporte_camaras' %}" class="header-btn primary">
    <i class="fas fa-plus"></i> Nuevo Reporte
</a>
{% endblock %}

{% block content %}
<div class="content-wrapper">
    <div class="filters-section">
        <div class="filters-title">游댌 Filtros de B칰squeda</div>
        <div class="filters-grid">
            <div class="filter-item">
                <label>Fecha Desde</label>
                <input type="date" id="fechaDesde">
            </div>
            <div class="filter-item">
                <label>Fecha Hasta</label>
                <input type="date" id="fechaHasta">
            </div>
            <div class="filter-item">
                <label>Turno</label>
                <select id="turno">
                    <option value="">Todos</option>
                    <option value="Ma침ana">Ma침ana</option>
                    <option value="Tarde">Tarde</option>
                    <option value="Noche">Noche</option>
                </select>
            </div>
            <div class="filter-item">
                <label>Responsable</label>
                <input type="text" id="responsable" placeholder="Nombre">
            </div>
            <div class="filter-item">
                <label>Centro con Novedades</label>
                <select id="centroIncidencias">
                    <option value="">Todos</option>
                    <option value="rio_pescado">R칤o Pescado</option>
                    <option value="collin">Coll칤n</option>
                    <option value="lican">Lican</option>
                    <option value="trafun">Traf칰n</option>
                </select>
            </div>
        </div>
        <div class="filter-actions">
            <button class="btn-clear" id="btnLimpiar">Limpiar</button>
            <button class="btn-filter" id="btnFiltrar"><i class="fas fa-search"></i> Buscar</button>
        </div>
    </div>

    <div class="results-header">
        <div class="results-title">游늶 Resultados</div>
        <div class="results-count" id="resultadosCount">0 reportes encontrados</div>
    </div>

    <div id="loadingContainer" class="loading">
        <p>Cargando reportes...</p>
    </div>

    <div class="table-container" id="tablaContainer">
        <table class="reports-table">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Turno</th>
                    <th>Responsable</th>
                    <th>Estado</th>
                    <th>Novedades</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="tablaBody">
                <tr>
                    <td colspan="6" class="empty-message">
                        <div class="empty-icon">游늶</div>
                        <div>Usa los filtros para buscar reportes</div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div id="modalDetalle" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">Detalle del Reporte</div>
            <button class="modal-close" onclick="cerrarModal()">&times;</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
    </div>
</div>

{% csrf_token %}
{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/consulta_reportes_camaras.js' %}"></script>
{% endblock %}
